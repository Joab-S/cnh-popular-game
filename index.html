<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-TWVM8MV8");
    </script>
    <!-- End Google Tag Manager -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Silkscreen&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Jersey+10&family=Jersey+15&family=Silkscreen:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="./public/assets/images/favicon.png" />
    <title>CNH Popular - Jogo</title>
  </head>
  <body style="margin: 0; background: #0e0e0e">
    <!-- Google Tag Manager (noscript) -->
    <noscript
      ><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-TWVM8MV8"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe
    ></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="game"></div>

    <!-- Phaser 3 via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.0/dist/phaser.js"></script>

    <!-- Nosso jogo -->
    <script type="module" src="./src/core/main.js"></script>
    <script>
      function getViewport() {
        const vv = window.visualViewport;
        return {
          width: vv ? vv.width : window.innerWidth,
          height: vv ? vv.height : window.innerHeight,
        };
      }

      function adjustOrientation() {
        const el = document.getElementById("game");
        if (!el) return;

        const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
        const { width: vw, height: vh } = getViewport();
        const isPortrait = vh > vw;

        let rotation = 0;
        // Reset do estilo
        Object.assign(el.style, {
          position: "fixed",
          top: "0",
          left: "0",
          width: "100%",
          height: "100%",
          transform: "none",
          background: "#ffffff",
          overflow: "hidden",
        });
        
        if (isMobile && isPortrait) {
          rotation = 90;
          const { width: vw, height: vh } = getViewport();
          const screenWidth = vh;
          const screenHeight = vw;

          const GAME_WIDTH = 800;
          const GAME_HEIGHT = 450;

          const gameRatio = GAME_WIDTH / GAME_HEIGHT;
          const screenRatio = screenWidth / screenHeight;

          let finalWidth, finalHeight;
          if (screenRatio > gameRatio) {
            finalHeight = screenHeight;
            finalWidth = finalHeight * gameRatio;
          } else {
            finalWidth = screenWidth;
            finalHeight = finalWidth / gameRatio;
          }

          el.style.position = "fixed";
          el.style.top = "50%";
          el.style.left = "50%";
          el.style.width = `${finalWidth}px`;
          el.style.height = `${finalHeight}px`;
          el.style.transformOrigin = "center";
          el.style.transform = `
            translate(-50%, -50%)
            rotate(90deg)
          `;
          el.style.background = "#fff";
          el.style.transform += `scale(${screenRatio * 0.75})`;
          const game = window.GAME;
          if (game && game.scale) {
          }
        }
      }

      window.addEventListener("load", adjustOrientation);
      window.addEventListener("resize", adjustOrientation);
      window.addEventListener("orientationchange", adjustOrientation);
      window.visualViewport &&
        window.visualViewport.addEventListener("resize", adjustOrientation);
    </script>
  </body>
</html>
